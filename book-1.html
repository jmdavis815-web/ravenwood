<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="UTF-8" />
  <title>Wards of the Manor ¬∑ Ravenwood Interactive Book</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Main Ravenwood styles -->
  <link rel="stylesheet" href="style.css" />

  <!-- Bootstrap -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    crossorigin="anonymous"
  />

  <style>
    /* --- Book layout helpers (minimal extra CSS) --- */

    body.rw-bg {
      background: radial-gradient(circle at top, #111827 0, #020617 60%);
      min-height: 100vh;
    }

    .rw-book-shell {
      max-width: 900px;
      margin: 0 auto;
    }

    .rw-book-body {
      max-height: none;
    }

    .rw-book-image-wrapper {
      margin-bottom: 1.75rem;
    }

    .rw-book-image-frame {
      position: relative;
      border-radius: 1rem;
      overflow: hidden;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: radial-gradient(circle at top, #0f172a 0, #020617 55%);
      min-height: 220px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .rw-book-image-frame img {
      width: 100%;
      height: auto;
      object-fit: cover;
      display: block;
    }

    /* Glow overlay where you want the talisman dropped */
    .rw-book-drop-hotspot {
      position: absolute;
      inset: 25% 30%;
      border: 2px dashed rgba(250, 204, 21, 0.8);
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle, rgba(250, 204, 21, 0.12), transparent);
      box-shadow: 0 0 28px rgba(250, 204, 21, 0.65);
      pointer-events: auto;
    }

    .rw-book-drop-label {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #fefce8;
      text-shadow: 0 1px 3px rgba(15, 23, 42, 0.9);
    }

    .rw-book-drop-hotspot.rw-drop-success {
      border-style: solid;
      box-shadow: 0 0 32px rgba(34, 197, 94, 0.9);
    }

    .rw-book-drop-hotspot.rw-drop-fail {
      border-color: rgba(239, 68, 68, 0.9);
      box-shadow: 0 0 32px rgba(239, 68, 68, 0.9);
    }

    .rw-book-choices button {
      text-align: left;
      white-space: normal;
    }

    .rw-book-choices button:disabled {
      opacity: 0.7;
      cursor: not-allowed;
    }

    .rw-book-page-meta {
      font-size: 0.8rem;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: #9ca3af;
    }

    /* Inventory panel specific to the book view */

    #rwBookInventoryPanel {
      max-width: 480px;
      margin: 0 auto 1.5rem;
      padding: 0.75rem 0.75rem 0.25rem;
      border-radius: 0.9rem;
      background: radial-gradient(circle at top left, #020617 0, #020617 45%, #030712 100%);
      border: 1px solid rgba(148, 163, 184, 0.4);
    }

    #rwBookInventoryGrid {
      margin-top: 0.5rem;
    }

    .rw-book-system-msg {
      min-height: 1.2rem;
    }

    @media (max-width: 768px) {
      .rw-book-image-frame {
        min-height: 180px;
      }
      #rwBookInventoryPanel {
        width: 100%;
      }
    }
  </style>
</head>
<body class="rw-bg" data-page="book">
  <!-- Simple nav back to Ravenwood -->
  <nav class="navbar navbar-expand-lg rw-navbar border-bottom">
    <div class="container">
      <a class="navbar-brand fw-semibold" href="ravenwood.html">
        Ravenwood
      </a>
      <span class="navbar-text small text-muted ms-3">
        Wards of the Manor ¬∑ Book I
      </span>
      <a href="ravenwood.html" class="btn btn-sm rw-btn-main ms-auto">
        ‚üµ Town &amp; Manor
      </a>
    </div>
  </nav>

  <main class="py-4 py-md-5">
    <div class="container rw-book-shell">
      <div class="rw-card p-4 p-md-5 shadow-lg">
        <header class="mb-4 text-center">
          <p class="rw-tagline text-uppercase mb-1">Interactive Ravenwood Story</p>
          <h1 class="rw-title mb-2">Wards of the Manor</h1>
          <p class="rw-body mb-0">
            Book I ¬∑ Your choices shape how the Manor remembers you. Read slowly, follow the paths that call to you, and
            let the talisman guide your way.
          </p>
        </header>

        <hr class="my-4" />

        <!-- Inventory toggle + panel -->
        <div class="d-flex justify-content-between align-items-center mb-2">
          <span class="rw-book-page-meta" id="rwBookPageMeta">Page 1</span>
          <button id="rwBookInventoryToggle" class="btn btn-outline-light btn-sm">
            üëú Open Inventory
          </button>
        </div>

        <div id="rwBookInventoryPanel" class="d-none">
          <div class="d-flex justify-content-between align-items-center">
            <span class="small text-muted">
                Tap an item in your pack to open options. Choose <strong>Use</strong> or <strong>Description</strong>.
            </span>
            <button class="btn btn-link btn-sm text-decoration-none text-muted" id="rwBookInventoryClose">
              Close ‚úï
            </button>
          </div>
          <div id="rwBookInventoryGrid" class="rw-inventory-grid mt-2"></div>
        </div>

        <!-- Page content -->
        <article id="rwBookPageContainer" class="rw-book-body">
          <!-- Image slot -->
          <div class="rw-book-image-wrapper">
            <div class="rw-book-image-frame">
              <!-- Replace src per page; you can drop real art for each scene -->
              <img
                id="rwBookImage"
                src="book-page-1.png"
                alt="Ravenwood Manor scene"
                onerror="this.style.display='none';"
              />
              <!-- Drag-drop hotspot for talisman -->
              <div id="rwBookDropHotspot" class="rw-book-drop-hotspot d-none">
                <span class="rw-book-drop-label">Drop the talisman here</span>
              </div>
            </div>
          </div>

          <h2 id="rwBookPageTitle" class="rw-title fs-4 mb-3"></h2>
          <div id="rwBookPageBody" class="rw-body mb-4"></div>

          <div id="rwBookSystemMessage" class="rw-book-system-msg small text-warning mb-2 d-none"></div>

          <div id="rwBookChoices" class="rw-book-choices d-flex flex-column gap-2 mb-3"></div>
        </article>
      </div>
    </div>
  </main>

  <!-- Bootstrap JS -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    crossorigin="anonymous"
  ></script>

  <!-- Supabase JS (v2) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- Your global Ravenwood logic (Supabase, inventory helpers, etc.) -->
  <script src="app.js"></script>

  <!-- Book engine -->
  <script>
  (function () {
    const TALISMAN_ITEM_ID = "old_talisman";

    // Simple state for this book session
    const BOOK_STATE = {
      currentPageId: "1",
      talismanUsedPages: {}, // { "5": true } etc.
      inventory: [],
    };

    // Supabase / character info for this book session
    let currentBookEmail = null;
    let currentBookChar = null;

    // Save book progress (Supabase)
    async function saveBookProgress(pageId, options = {}) {
      if (!currentBookEmail) return;

      try {
        const update = {
          book1_started: true,
          book1_last_page: pageId,
        };

        if (options.completed === true) {
          update.book1_completed = true;
        }

        const { error } = await supabaseClient
          .from("data")
          .update(update)
          .eq("email", currentBookEmail);

        if (error) {
          console.error("Failed to save book progress:", error);
        } else if (currentBookChar) {
          currentBookChar.book1_started = true;
          currentBookChar.book1_last_page = pageId;
        }
      } catch (err) {
        console.error("Unexpected error saving book progress:", err);
      }
    }

    // --- PAGE DATA ---
    const BOOK_PAGES = {
      "1": {
        title: "The Manor That Waits",
        image: "b1-p1.png",
        body: `
          <p>
            Fog curls around your boots as you step onto the ancient path. Lanterns along the drive gutter, then flare
            brighter, as if recognizing the metal resting in your pocket.
          </p>
          <p>
            The Manor looms ahead: windows burning with a few patient lights, stone black with old rain. The air hums
            faintly. Not storm, not wind. <em>Attention.</em>
          </p>
          <p>
            When your foot crosses the final stone at the threshold, the great door opens on its own‚Äînot with a creak,
            but with a long, low <em>sigh</em>, as though the house is finally waking.
          </p>
          <p>
            A woman with silver hair waits just inside the hall, eyes sharp, expression somewhere between relief and
            apology.
          </p>
          <p class="rw-intro-dialog">
            ‚ÄúYou brought it back,‚Äù she says softly. ‚ÄúThe talisman.‚Äù
          </p>
        `,
        choices: [
          { text: "Step inside cautiously.", to: "2" },
          { text: "Enter as if you belong here.", to: "2" },
          { text: "Ask who she is before crossing the threshold.", to: "2" },
        ],
      },

      "2": {
        title: "Mira Ashbourne",
        image: "b1-p2.png",
        body: `
          <p>
            You step into the entry hall. Warm golden light spills from lanterns clustered along carved stone pillars,
            flickering like breath. The floor beneath you is marked with a circle of old sigils, worn by time but still
            faintly luminous.
          </p>
          <p>
            The silver-haired woman studies you‚Äînot suspicious, but searching, as if listening to something just
            behind your heartbeat.
          </p>
          <p>
            ‚ÄúMira Ashbourne,‚Äù she says. ‚ÄúKeeper of the Manor. Ward-tender. And until tonight‚Ä¶‚Äù Her mouth twists into a
            wry almost-smile. ‚Äú‚Ä¶the only one left listening when it cries.‚Äù
          </p>
          <p>
            The talisman at your chest hums‚Äîa low, steady vibration‚Äîanswering the glow in the floor. Lines of light
            stir between stone and metal, spider-fine threads reaching for one another.
          </p>
          <p class="rw-intro-dialog">
            ‚ÄúThe wards woke for you,‚Äù Mira continues. ‚ÄúThat means the story is shifting. That means you‚Äôre not just a
            visitor. You‚Äôre an <strong>anchor</strong>.‚Äù
          </p>
        `,
        choices: [
          { text: "‚ÄúWhat does it mean to be an anchor?‚Äù", to: "3" },
          { text: "Ignore the title‚Äîask what‚Äôs wrong with the wards.", to: "3" },
          { text: "Touch the talisman and see how it responds.", to: "3" },
        ],
      },

      "3": {
        title: "The Listening Door",
        image: "book-page-3.png",
        body: `
          <p>
            Mira leads you deeper into the hall. Portraits with blurred faces line the walls; some seem to turn
            slightly as you pass. Above, a chandelier hums like a throat swallowing light.
          </p>
          <p>
            At the far end of the hall stands a tall double door, its surface carved with layered sigils. Bands of
            pale light cinch it shut like glowing iron.
          </p>
          <p>
            ‚ÄúThe Manor has layers,‚Äù Mira murmurs. ‚ÄúThis door sits where the living house brushes the level just above
            the Underhall. The older wards gather here.‚Äù
          </p>
          <p>
            As you draw near, your talisman warms. The bands of light along the door vibrate, threads of brilliance
            reaching toward the metal at your throat.
          </p>
          <p class="rw-intro-dialog">
            ‚ÄúIt wants to see you,‚Äù Mira says. ‚ÄúLet it.‚Äù
          </p>
        `,
        choices: [
          { text: "Press your palm to the door.", to: "4" },
          { text: "Raise the talisman toward the bands of light.", to: "4" },
          { text: "Whisper your name to the wood.", to: "4" },
        ],
      },

      "4": {
        title: "Contact",
        image: "book-page-4.png",
        body: `
          <p>
            The moment your palm touches the carved wood, the bands of light flare. A low note thrums through your
            bones. Images tumble across your mind‚Äîfractured pieces of yourself the Manor has no right to know:
            childhood rooms, a familiar voice calling you back, the first time you dreamed of a hill crowned with a
            house you‚Äôd never seen.
          </p>
          <p>
            The talisman sears hot, then cools. Threads of light leap from the door to the metal, then sink inward,
            vanishing beneath your skin.
          </p>
          <p>
            The door hums approval. Something deeper beneath the Manor hums back.
          </p>
          <p class="rw-intro-dialog">
            ‚ÄúThe first gate is open,‚Äù Mira says quietly. ‚ÄúAnd the Underhall knows your name now.‚Äù
          </p>
        `,
        choices: [
          { text: "Step through the door.", to: "5" },
          { text: "Ask what changed when the gate opened.", to: "5" },
          { text: "Demand to know what the Underhall is.", to: "5" },
        ],
      },

      "5": {
        title: "The Wall That Breathes",
        image: "book-page-5.png",
        body: `
          <p>
            Beyond the listening door, the corridor slopes downward in a slow arc. Lanterns burn with a cold,
            silver-blue flame. The air smells of stone, old wax, and something like rain trapped underground.
          </p>
          <p>
            You feel the Manor thin here. Its skin brushes something deeper‚Äîthe Underhall‚Äôs unseen tide.
          </p>
          <p>
            Halfway down the passage, your talisman jolts. Heat flares against your skin, then tugs, insistent,
            pulling your attention toward an unremarkable stretch of wall.
          </p>
          <p>
            To the eye, it‚Äôs just stone. To the talisman, it <em>breathes</em>.
          </p>
          <p>
            As you watch, faint lines ripple across the surface‚Äîan almost-circle, not yet complete. An old lock
            waiting to remember its key.
          </p>
          <p class="rw-intro-dialog">
            ‚ÄúThat shouldn‚Äôt be waking,‚Äù Mira whispers. ‚ÄúIf you‚Äôre going to use the talisman‚Ä¶ do it carefully.‚Äù
          </p>
          <p class="small text-muted mb-0">
            <em>Open your inventory, select the talisman, and choose <strong>Use</strong> when you‚Äôre ready to test the waking wall.</em>
          </p>
        `,
        requiresTalisman: true,
        dropHint:
        "The hidden lock warms as the talisman nears. Use the talisman while you‚Äôre looking at the wall.",
        dropSuccessText:
          "The stone drinks in the talisman‚Äôs light. A circle completes itself in the wall with a soft chime, and the rock folds inward, revealing a narrow vault beyond.",
        choices: [
          { text: "Step into the newly opened vault.", to: "6" },
          { text: "Look back at Mira before entering.", to: "6" },
        ],
      },

      "6": {
        title: "The Thread-Vault",
        image: "book-page-6.png",
        body: `
          <p>
            The passage beyond the wall is narrow and warm, lit by no visible lanterns‚Äîonly a suspended web of
            silver threads, each one softly luminous. They sway in a breeze you can‚Äôt feel.
          </p>
          <p>
            At the center of the chamber stands a pedestal. Resting on it is a single feather made of shifting light,
            its edges dissolving into glowing motes before reforming again.
          </p>
          <p>
            The talisman, still warm against your skin, thrums in time with the feather‚Äôs slow pulse.
          </p>
          <p class="rw-intro-dialog">
            ‚ÄúAn echo-vault,‚Äù Mira breathes. ‚ÄúUntouched since before my grandmother‚Äôs time. The Manor hid this from me.‚Äù
          </p>
          <p>
            Silver threads brush against your shoulders as you move, humming like distant voices. You have the
            unsettling feeling that every step you take in here will matter more than the ones outside.
          </p>
        `,
        choices: [
          { text: "Reach toward the feather of light.", to: "1" },
          { text: "Back away‚Äîthis is too much for one night.", to: "1" },
        ],
      },
    };

    // --- INVENTORY LOADING (from game if possible, else fallback) ---
    function loadBookInventory() {
      // 1) If world page seeded inventory from Supabase, use that
      if (Array.isArray(window.rwInitialInventory) && window.rwInitialInventory.length) {
        return [...window.rwInitialInventory];
      }

      // 2) Try localStorage fallback
      try {
        const raw = localStorage.getItem("ravenwoodInventory");
        if (raw) {
          const parsed = JSON.parse(raw);
          if (Array.isArray(parsed) && parsed.length) {
            return parsed;
          }
        }
      } catch (e) {
        console.warn("Could not load book inventory from localStorage:", e);
      }

      // 3) Last resort: grant a basic talisman so the puzzle works
      return [
        {
          id: TALISMAN_ITEM_ID,
          name: "Old Talisman",
          icon: "tal-tri.png",
          quantity: 1,
        },
      ];
    }

    function renderBookInventory() {
      const grid = document.getElementById("rwBookInventoryGrid");
      if (!grid) return;

      grid.innerHTML = "";

      const items = BOOK_STATE.inventory;
      const maxSlots = 12;
      const safeItems = Array.isArray(items) ? items : [];

      safeItems.forEach((item) => {
        const slot = document.createElement("div");
        slot.className = "rw-inventory-slot";

        if (item && item.icon) {
  const img = document.createElement("img");
  img.src = item.icon;
  img.alt = item.name || "Item";
  img.className = "rw-inventory-item-icon";
  img.dataset.itemId = item.id;

  // üîπ NEW: click to open Use / Description menu (book context)
  if (window.rwOpenItemMenu) {
    img.addEventListener("click", () =>
      window.rwOpenItemMenu(item, { origin: "book" })
    );
  }

  slot.appendChild(img);
}

        if (item && item.quantity && item.quantity > 1) {
          const badge = document.createElement("span");
          badge.className = "rw-inventory-qty";
          badge.textContent = item.quantity;
          slot.appendChild(badge);
        }

        grid.appendChild(slot);
      });

      // Fill empty slots
      for (let i = safeItems.length; i < maxSlots; i++) {
        const empty = document.createElement("div");
        empty.className = "rw-inventory-slot";
        grid.appendChild(empty);
      }
    }

    // --- SYSTEM MESSAGE ---
    function setSystemMessage(text, kind = "warning") {
      const el = document.getElementById("rwBookSystemMessage");
      if (!el) return;
      if (!text) {
        el.classList.add("d-none");
        el.textContent = "";
        return;
      }
      el.classList.remove("d-none");
      el.textContent = text;
      el.classList.toggle("text-warning", kind === "warning");
      el.classList.toggle("text-success", kind === "success");
      el.classList.toggle("text-danger", kind === "danger");
    }

    // --- BOOK CONTEXT: inventory item use handler ---
// Called from app.js via handleItemUse(..., { origin: "book" })
window.rwBookHandleItemUse = function (item) {
  if (!item || !item.id) return;

  const pageId = BOOK_STATE.currentPageId;
  const page = BOOK_PAGES[pageId];

  // The talisman has special behavior
  if (item.id === TALISMAN_ITEM_ID) {
    if (page && page.requiresTalisman) {
      if (!BOOK_STATE.talismanUsedPages[pageId]) {
        BOOK_STATE.talismanUsedPages[pageId] = true;
      }
      setSystemMessage(
        "The talisman warms in your hand. Light seeps into the waiting ward.",
        "success"
      );
      renderPage(pageId); // re-render so success text + choices unlock
    } else {
      setSystemMessage(
        "You lift the talisman, but the wards here stay quiet. Nothing happens.",
        "warning"
      );
    }
    return;
  }

  // Any other item (for now): nothing happens
  setSystemMessage(
    "You try to use that here, but the scene doesn‚Äôt respond. Nothing happens.",
    "danger"
  );
};

    // --- PAGE RENDERING ---
    function renderPage(pageId) {
  const page = BOOK_PAGES[pageId];
  if (!page) return;

  BOOK_STATE.currentPageId = pageId;

  const titleEl = document.getElementById("rwBookPageTitle");
  const bodyEl = document.getElementById("rwBookPageBody");
  const imgEl = document.getElementById("rwBookImage");
  const metaEl = document.getElementById("rwBookPageMeta");
  const dropZone = document.getElementById("rwBookDropHotspot");

  if (titleEl) titleEl.textContent = page.title || "";
  if (metaEl) metaEl.textContent = "Page " + pageId;

  if (bodyEl) {
    bodyEl.innerHTML = page.body || "";
  }

  if (imgEl) {
    if (page.image) {
      imgEl.src = page.image;
      imgEl.style.display = "";
    } else {
      imgEl.style.display = "none";
    }
  }

  const needsTalisman = !!page.requiresTalisman;
  const alreadyUsed = !!BOOK_STATE.talismanUsedPages[pageId];

  // We no longer use drag & drop; keep the hotspot hidden.
  if (dropZone) {
    dropZone.classList.add("d-none");
  }

  if (needsTalisman && alreadyUsed && page.dropSuccessText && bodyEl) {
    const extra = document.createElement("p");
    extra.className = "rw-body mt-2";
    extra.innerHTML = `<em>${page.dropSuccessText}</em>`;
    bodyEl.appendChild(extra);
    setSystemMessage("The talisman answered. New paths are open.", "success");
  }

  renderChoicesForPage(pageId);

  // Save progress whenever we fully render this page
  saveBookProgress(pageId);
}

    function renderChoicesForPage(pageId) {
  const page = BOOK_PAGES[pageId];
  if (!page) return;

  const choicesEl = document.getElementById("rwBookChoices");
  if (!choicesEl) return;

  const needsTalisman = !!page.requiresTalisman;
  const alreadyUsed = !!BOOK_STATE.talismanUsedPages[pageId];

  choicesEl.innerHTML = "";

  if (!Array.isArray(page.choices) || !page.choices.length) {
    const p = document.createElement("p");
    p.className = "small text-muted";
    p.textContent = "There are no choices here yet.";
    choicesEl.appendChild(p);
    return;
  }

  page.choices.forEach((choice) => {
    const btn = document.createElement("button");
    btn.type = "button";
    btn.className = "btn rw-btn-main w-100";
    btn.textContent = choice.text;

    if (needsTalisman && !alreadyUsed) {
      btn.disabled = true;
    }

    btn.addEventListener("click", () => {
      if (choice.to && BOOK_PAGES[choice.to]) {
        renderPage(choice.to);
        window.scrollTo({ top: 0, behavior: "smooth" });
      }
    });

    choicesEl.appendChild(btn);
  });

  if (needsTalisman && !alreadyUsed) {
    setSystemMessage(
      page.dropHint ||
        "The wall is still waiting. Use your talisman here before you choose your next step.",
      "warning"
    );
  } else {
    // Clear any lingering message if this page doesn't need the talisman
    setSystemMessage(null);
  }
}

    // --- INVENTORY TOGGLE CONTROLS ---
    function initInventoryToggle() {
      const toggleBtn = document.getElementById("rwBookInventoryToggle");
      const closeBtn = document.getElementById("rwBookInventoryClose");
      const panel = document.getElementById("rwBookInventoryPanel");
      if (!toggleBtn || !panel) return;

      function showPanel() {
        panel.classList.remove("d-none");
      }
      function hidePanel() {
        panel.classList.add("d-none");
      }

      toggleBtn.addEventListener("click", () => {
        if (panel.classList.contains("d-none")) {
          showPanel();
        } else {
          hidePanel();
        }
      });

      if (closeBtn) {
        closeBtn.addEventListener("click", hidePanel);
      }
    }

    // --- INIT ON LOAD ---
    document.addEventListener("DOMContentLoaded", async () => {
      // 1) Ensure a logged-in Supabase user
      try {
        const { data, error } = await supabaseClient.auth.getUser();
        if (error || !data || !data.user || !data.user.email) {
          window.location.href = "login.html";
          return;
        }
        currentBookEmail = data.user.email.toLowerCase();

        // 2) Load their character row
        try {
          currentBookChar = await fetchCharacterByEmail(currentBookEmail);
        } catch (e) {
          console.error("Could not load character for book:", e);
        }
      } catch (e) {
        console.error("Supabase auth error in book:", e);
      }

      // 3) Seed inventory (prefer Supabase)
      if (currentBookChar && Array.isArray(currentBookChar.inventory)) {
        BOOK_STATE.inventory = [...currentBookChar.inventory];
      } else {
        BOOK_STATE.inventory = loadBookInventory();
      }
      renderBookInventory();

      // Inventory UI (no more drag/drop; items are used via the click menu)
        initInventoryToggle();

      // 4) Decide starting page (resume if possible)
      let startPage = "1";
      if (
        currentBookChar &&
        currentBookChar.book1_last_page &&
        BOOK_PAGES[currentBookChar.book1_last_page]
      ) {
        startPage = currentBookChar.book1_last_page;
      }

      BOOK_STATE.currentPageId = startPage;

      // Mark as started & save initial progress
      await saveBookProgress(startPage);

      // Render starting page
      renderPage(startPage);
    });
  })();
</script>
</body>
</html>
